A = 0x5b9e402b76181c9c95ce28ced7dde4c04d1e1f5773e9e67e4c907c8fa7c390cc
B = 0x1808a604ed7dedcf26e8e371a4e312a51fae740f749aaac0ac10c9cc3469d8d4
n = 0x99925173ad65686715385ea800cd28120288fc70a9bc98dd4c90d676f8ff768d
np = 0x8833c3bb

# 1
A_in = 0xa7c390cc
B_in = 0x1808a604ed7dedcf26e8e371a4e312a51fae740f749aaac0ac10c9cc3469d8d4
C_in = 0x0
U = A_in * B_in + C_in
0x0fc0007bb0f51e925d4a96ba63a5e5700ae1acffdd23e51bac4e76c07ba0a547c3cc08f0
0x0fc0007bb0f51e925d4a96ba63a5e5700ae1acffdd23e51bac4e76c07ba0a547c3cc08f0

# 2 m = u0*np
A_in = 0xc3cc08f0
B_in = 0x8833c3bb
C_in = 0x0
M = (A_in * B_in + C_in) % 2**32
M = 0xb8a95750

# 3 U = m*n
A_in = 0xb8a95750
B_in = 0x99925173ad65686715385ea800cd28120288fc70a9bc98dd4c90d676f8ff768d
C_in = 0x0fc0007bb0f51e925d4a96ba63a5e5700ae1acffdd23e51bac4e76c07ba0a547c3cc08f0
U = A_in * B_in + C_in
0x7e86c0ff525b3da207c3c5666aea8e726952735cd61cad5fc85116b0b94816ef00000000
0x7e86c0ff525b3da206c3c5666aea8e726952735cd61cad5fc85116b0b94816ef00000000

# 2 1 u = u + ab
A_in = 0x4c907c8f
B_in = 0x1808a604ed7dedcf26e8e371a4e312a51fae740f749aaac0ac10c9cc3469d8d4
C_in = 0x000000007e86c0ff525b3da207c3c5666aea8e726952735cd61cad5fc85116b0b94816ef
U = A_in * B_in + C_in
0x073021d8f50cda383ef671b73ee607030513909d7b4c462b22ad27b229dda10e2caee55b
0x073021d8f50cda383ef671b73ee607030513909d7b4c462b22ad27b229dda10e2caee55b

# 2 1 u = u + ab
A_in = 0xcde7b9e8
B_in = 0x99925173ad65686715385ea800cd28120288fc70a9bc98dd4c90d676f8ff768d
C_in = 0x1444185fa399cf7dfd82ca670f25abc00815a89db344b026b73f9850cfc29a3cd995ab38
U = A_in * B_in + C_in


0x8fc94626ae4be3bd2ade2fd1f8dfdeca983ef886ff6c1080faa21fa1a8c0307200000000
0x8fc94626ae4be3bd2ade2fd1f8dfdeca983ef886ff6c1080faa21fa1a8c0307200000000
print(hex(U))
